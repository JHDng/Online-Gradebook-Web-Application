title Event: GoToExamRecord

participant Request
participant GoToExamRecord
participant Session
participant ExamRecordDAO
participant ctx
participant examRecord.html
participant Response

Request->GoToExamRecord: doGet(recordID)

alt !SafeChecker.isStringSafe(recordID_str)
    GoToExamRecord->Response: sendError(400, "Invalid record id")
else
        GoToExamRecord->Session: getAttribute("user")
        GoToExamRecord->ExamRecordDAO: findRecordbyRecordID(recordID, userUUID)
        ExamRecordDAO->GoToExamRecord: examRecord || null

        alt examRecord == null
            GoToExamRecord->Response: sendError(400, "No exam record with that id")
        else
            GoToExamRecord->ExamRecordDAO: findStudentsByRecordID(examRecord.recordID)
            ExamRecordDAO->GoToExamRecord: studentRegistrationList

            alt studentRegistrationList == null || studentRegistrationList.isEmpty
                GoToExamRecord->Response: sendError(400, "No students found in this record (impossible)")
            else
                GoToExamRecord->ctx: setVariable("record", "studentRegistrations")
                GoToExamRecord->examRecord.html: templateEngine.process(path, ctx, response.getWriter())
        end
    end
end
